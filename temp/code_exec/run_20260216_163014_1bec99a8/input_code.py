from collections import defaultdict\nimport sympy as sp\n\nchunks = [\n    ('A', 1),\n    ('B', 2),\n    ('A', 3),\n    ('B', 4),\n    ('A', 5),\n]\n\ncounts = defaultdict(int)\nsums = defaultdict(sp.Integer(0))\nsum_sqs = defaultdict(sp.Integer(0))\n\nfor entity, val in chunks:\n    x = sp.Integer(val)\n    counts[entity] += 1\n    sums[entity] += x\n    sum_sqs[entity] += x**2\n\nentity = 'A'\nn = counts[entity]\nmean = sums[entity] / n\nvar = (sum_sqs[entity] - sums[entity]**2 / n) / n\nresult = var\nprint(result)